<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Happy 1 month sayang ‚Äî Sayangnya kamu</title>
  <style>
    :root{
      --pink:#ffdce6;
      --panel:#fff7fb;
      --accent:#ff83b6;
      --muted:#6b6b6b;
    }
    html,body{height:100%;margin:0;font-family:Inter, system-ui, -apple-system, 'Segoe UI', Roboto, 'Helvetica Neue', Arial; background:var(--pink); color:#111}
    .wrap{max-width:760px;margin:24px auto;padding:18px;box-sizing:border-box}
    .card{background:var(--panel);border-radius:16px;box-shadow:0 6px 20px rgba(15,15,20,0.08);padding:18px}
    h1{margin:0 0 8px;font-size:20px;color:#3b1660}
    p.lead{margin:0 0 12px;color:var(--muted)}
    .gate{display:flex;gap:8px;margin-bottom:12px}
    .gate input{flex:1;padding:10px;border-radius:10px;border:1px solid rgba(0,0,0,0.06)}
    .gate button{background:var(--accent);color:white;border:0;padding:10px 14px;border-radius:10px}
    .quiz{margin-top:14px}
    .q{margin:12px 0}
    .q label{display:block;font-weight:600;margin-bottom:6px}
    .q input[type=text]{width:100%;padding:10px;border-radius:8px;border:1px solid rgba(0,0,0,0.06)}
    .choices{display:flex;gap:8px}
    .choices button{flex:1;padding:10px;border-radius:8px;border:1px solid rgba(0,0,0,0.06);background:white}
    .scrap-wrap{margin-top:18px;border-radius:12px;overflow:hidden;opacity:0;transform:translateY(8px)}
    .gallery{display:flex;flex-direction:column;gap:12px;overflow:auto;padding:12px;max-height:520px}
    .scrap-img{width:100%;height:auto;border-radius:10px;box-shadow:0 6px 18px rgba(0,0,0,0.06);object-fit:cover}
    .surat{margin-top:18px}
    .surat textarea{width:100%;min-height:140px;padding:12px;border-radius:10px;border:1px solid rgba(0,0,0,0.06)}
    .btns{display:flex;gap:8px;margin-top:8px}
    .small{font-size:13px;color:var(--muted)}
    footer{margin-top:18px;text-align:center;color:var(--muted);font-size:13px}
    .hidden{display:none}
    .fade-in{animation:fadeInUp .45s ease forwards}
    @keyframes fadeInUp{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
    @media (max-width:480px){.gallery{max-height:760px}}
  </style>
</head>
<body>
  <div class="wrap">
    <div class="card">
      <h1>Happy 1 month sayang</h1>
      <p class="lead">Masukkan password untuk buka. (hint: kamu udah kasih)</p>
      <div class="gate" id="gate">
        <input id="pw" placeholder="Masukkan password..." />
        <button id="openBtn">Buka</button>
      </div>
      <div id="lockedMsg" class="small">(Situs ini pribadi ‚Äî jangan share link tanpa ijin)</div>
      <div id="content" style="display:none">
        <div class="quiz card" id="quizSection">
          <strong>Quiz singkat biar aku yakin itu kamu ü•π</strong>
          <div class="q">
            <label>1) Berapa tanggal lahir kamu? (tanggal & bulan)</label>
            <input id="q1" type="text" placeholder="contoh: 01 Oktober" />
          </div>
          <div class="q">
            <label>2) Makanan kesukaan kamu apa sayang?</label>
            <input id="q2" type="text" placeholder="nasi goreng, soto, dll" />
          </div>
          <div class="q">
            <label>3) Kamu sayang aku gak?</label>
            <div class="choices">
              <button data-val="Sayang banget">Sayang banget</button>
              <button data-val="Sayang pokoknya">Sayang pokoknya</button>
            </div>
            <input id="q3" type="hidden" />
          </div>
          <div class="q">
            <label>4) Hal yang paling kamu suka dari aku apa?</label>
            <input id="q4" type="text" />
          </div>
          <div class="q">
            <label>5) Hal apa yang kamu pengen dari aku?</label>
            <input id="q5" type="text" />
          </div>
          <div style="display:flex;gap:8px;margin-top:10px">
            <button id="submitQuiz" style="background:var(--accent);color:white;padding:10px;border-radius:10px;border:0">Kirim Jawaban</button>
            <button id="saveJSON" style="padding:10px;border-radius:10px;border:1px solid rgba(0,0,0,0.06)">Save ke device</button>
            <button id="resetBtn" style="padding:10px;border-radius:10px;border:1px solid rgba(0,0,0,0.06);background:#fff">Reset Quiz</button>
          </div>
          <div id="quizMsg" class="small" style="margin-top:8px"></div>
        </div>
        <div class="scrap-wrap card hidden" id="scrapWrap">
          <strong>Our Scrapbook</strong>
          <div style="margin-top:12px">
            <div class="gallery" id="gallery">
              <img class="scrap-img" data-src="images/scrap_long.png" alt="scrap panjang" loading="lazy" />
            </div>
          </div>
          <div class="small" style="margin-top:8px">(Scrapbook hanya muncul setelah semua quiz dijawab ‚Äî scroll untuk lihat gambar)</div>
        </div>
        <div class="surat card hidden" id="suratSection">
          <strong>Surat-ku (kamu bisa pilih atau tulis baru)</strong>
          <select id="preset" style="margin-top:8px;padding:8px;border-radius:8px;border:1px solid rgba(0,0,0,0.06);width:100%">
            <option value="">Pilih surat lucu / manis...</option>
            <option value="1">Surat 1 ‚Äî 'Aku Telpon Kamu Nanti' (lucu)</option>
            <option value="2">Surat 2 ‚Äî 'Maaf Aku Makan Semua Cemilanmu' (gemas)</option>
            <option value="3">Surat 3 ‚Äî 'Aku Kangen, Tolong Balas' (manis)</option>
          </select>
          <textarea id="surat" placeholder="Tulis suratmu di sini...">Hai sayang, aku bikin ini buat kamu. Kamu selalu jadi bagian yang bikin aku senyum. ‚Äî (tambahin yang lucu ya)</textarea>
          <div class="btns">
            <button id="saveSurat" style="background:var(--accent);color:white;padding:10px;border-radius:10px;border:0">Simpan Surat</button>
            <button id="downloadSurat" style="padding:10px;border-radius:10px;border:1px solid rgba(0,0,0,0.06)">Download</button>
          </div>
        </div>
        <footer class="card small">Made with ‚ù§Ô∏è ‚Äî private page. Tekan tombol "Save ke device" di quiz untuk simpan jawaban.</footer>
      </div>
    </div>
  </div>
  <audio id="bgm" preload="auto" src="audio/alamak.mp3"></audio>
  <script>
    const PASSWORD = '011025';
    const pwInput = document.getElementById('pw');
    const openBtn = document.getElementById('openBtn');
    const content = document.getElementById('content');
    const gate = document.getElementById('gate');
    const bgm = document.getElementById('bgm');
    const scrapWrap = document.getElementById('scrapWrap');
    const gallery = document.getElementById('gallery');
    const suratSection = document.getElementById('suratSection');
    const resetBtn = document.getElementById('resetBtn');
    openBtn.addEventListener('click',()=>{
      if(pwInput.value.trim()===PASSWORD){
        gate.style.display='none';
        content.style.display='block';
        localStorage.setItem('scrap_unlocked','1');
        maybeRevealAfterPassword();
      } else {
        alert('Password salah sayang üíî');
      }
    });
    if(localStorage.getItem('scrap_unlocked')){
      gate.style.display='none'; content.style.display='block';
      maybeRevealAfterPassword();
    }
    function maybeRevealAfterPassword(){
      const completed = !!localStorage.getItem('scrap_quiz');
      if(completed){
        revealScrapAndSurat();
      } else {
        scrapWrap.classList.add('hidden');
        suratSection.classList.add('hidden');
      }
    }
    function revealScrapAndSurat(){
      const imgs = gallery.querySelectorAll('img[data-src]');
      imgs.forEach(img => {
        if(!img.src){
          img.src = img.dataset.src;
          img.addEventListener('load', ()=> console.log('Image loaded:', img.src));
          img.addEventListener('error', ()=> {
            console.error('Failed to load image:', img.dataset.src);
            img.style.display = 'none';
            const err = document.createElement('div');
            err.textContent = 'Gagal memuat gambar. Cek path / nama file.';
            err.style.color = 'crimson';
            err.style.padding = '8px';
            img.parentNode.insertBefore(err, img);
          });
        }
      });
      scrapWrap.classList.remove('hidden');
      suratSection.classList.remove('hidden');
      scrapWrap.classList.add('fade-in');
      suratSection.classList.add('fade-in');
      bgm.play().catch(()=>{});
    }
    document.querySelectorAll('.choices button').forEach(b=>{
      b.addEventListener('click',()=>{
        document.getElementById('q3').value=b.dataset.val;
        document.querySelectorAll('.choices button').forEach(x=>{ x.style.background=''; x.style.color=''; });
        b.style.background='var(--accent)'; b.style.color='white';
      });
    });
    function validateQuiz(){
      const q1=document.getElementById('q1').value.trim();
      const q2=document.getElementById('q2').value.trim();
      const q3=document.getElementById('q3').value.trim();
      const q4=document.getElementById('q4').value.trim();
      const q5=document.getElementById('q5').value.trim();
      return q1 && q2 && q3 && q4 && q5;
    }
    document.getElementById('submitQuiz').addEventListener('click',()=>{
      if(!validateQuiz()){
        document.getElementById('quizMsg').textContent='Isi semua pertanyaan dulu ya sayang üòä';
        return;
      }
      const data = {
        q1:document.getElementById('q1').value.trim(),
        q2:document.getElementById('q2').value.trim(),
        q3:document.getElementById('q3').value.trim(),
        q4:document.getElementById('q4').value.trim(),
        q5:document.getElementById('q5').value.trim(),
        at:new Date().toISOString()
      };
      localStorage.setItem('scrap_quiz', JSON.stringify(data));
      document.getElementById('quizMsg').textContent='Jawaban tersimpan! Scrapbook & surat sekarang terbuka ‚ù§Ô∏è';
      revealScrapAndSurat();
    });
    document.getElementById('saveJSON').addEventListener('click',()=>{
      const s = localStorage.getItem('scrap_quiz');
      if(!s){ alert('Belum ada jawaban, kirim dulu ya.'); return; }
      const obj = JSON.parse(s);
      const header = 'key,value\n';
      const rows = Object.keys(obj).map(k => {
        const v = (obj[k] === undefined || obj[k] === null) ? '' : String(obj[k]).replace(/\"/g, '""');
        return `${k},"${v}"`;
      }).join('\n');
      const csv = header + rows;
      const blob = new Blob([csv],{type:'text/csv'});
      const a = document.createElement('a');
      a.href = URL.createObjectURL(blob);
      a.download = 'scrap_quiz.csv';
      a.click();
    });
    resetBtn.addEventListener('click',()=>{
      const ok = confirm('Reset semua jawaban & pengaturan ‚Äî mau coba lagi?');
      if(!ok) return;
      localStorage.removeItem('scrap_quiz');
      localStorage.removeItem('scrap_unlocked');
      localStorage.removeItem('surat_text');
      const ph = document.getElementById('playHint'); if(ph) ph.remove();
      location.reload();
    });
    const presets = {
      '1': 'Hai sayang, aku nggak jadi gangguin kamu malam ini. Tapi inget ya, aku bakal telpon kalo aku kangen. ‚Äì Lucu kan? üòù',
      '2': 'Maaf ya, aku makan cemilanmu. Tapi tenang, nanti kubeli lagi. Love you! üíñ',
      '3': 'Aku kangen banget, tolong balas walau cuma emoji. üò≠üòò'
    };
    document.getElementById('preset').addEventListener('change',e=>{
      const val=e.target.value; if(val && presets[val]) document.getElementById('surat').value=presets[val];
    });
    document.getElementById('saveSurat').addEventListener('click',()=>{
      localStorage.setItem('surat_text', document.getElementById('surat').value);
      alert('Surat tersimpan!');
    });
    document.getElementById('downloadSurat').addEventListener('click',()=>{
      const text = document.getElementById('surat').value;
      const blob = new Blob([text],{type:'text/plain'});
      const a = document.createElement('a'); a.href=URL.createObjectURL(blob); a.download='surat-ku.txt'; a.click();
    });
    const saved = localStorage.getItem('surat_text'); if(saved) document.getElementById('surat').value=saved;
  </script>
</body>
</html>
